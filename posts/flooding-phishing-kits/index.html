<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>PhishFlood: a poc for flooding phishing kits | andpalmier</title>
<meta name="keywords" content="phishing, go">
<meta name="description" content="Flooding a phishing kit with fake data to make it harder for threat actors">
<meta name="author" content="">
<link rel="canonical" href="https://andpalmier.com/posts/flooding-phishing-kits/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.385652845d5bf34ec58b4ee7474842d3066fb85201eb3ac4ccf922cfac99eb2b.css" integrity="sha256-OFZShF1b807Fi07nR0hC0wZvuFIB6zrEzPkiz6yZ6ys=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://andpalmier.com/images/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://andpalmier.com/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://andpalmier.com/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://andpalmier.com/apple-touch-icon.png">
<link rel="mask-icon" href="https://andpalmier.com/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://andpalmier.com/posts/flooding-phishing-kits/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><meta property="og:title" content="PhishFlood: a poc for flooding phishing kits" />
<meta property="og:description" content="Flooding a phishing kit with fake data to make it harder for threat actors" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://andpalmier.com/posts/flooding-phishing-kits/" /><meta property="og:image" content="https://andpalmier.com/papermod-cover.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-01-31T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-01-31T00:00:00+00:00" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://andpalmier.com/papermod-cover.png"/>

<meta name="twitter:title" content="PhishFlood: a poc for flooding phishing kits"/>
<meta name="twitter:description" content="Flooding a phishing kit with fake data to make it harder for threat actors"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://andpalmier.com/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "PhishFlood: a poc for flooding phishing kits",
      "item": "https://andpalmier.com/posts/flooding-phishing-kits/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "PhishFlood: a poc for flooding phishing kits",
  "name": "PhishFlood: a poc for flooding phishing kits",
  "description": "Flooding a phishing kit with fake data to make it harder for threat actors",
  "keywords": [
    "phishing", "go"
  ],
  "articleBody": " Introduction If you use Twitter to stay up to date with the latest security news, you may have noticed a community of researchers reporting phishing websites and scam pages everyday (if you want to follow them, phishunt.io have a good list of profiles in their community section).\nUnfortunately, reporting these websites is not always very effective. In many cases the phishing pages are removed only after 24-48 hours of being reported, and at that point they may have already stolen credentials from a lot of victims. In order to maximize their effectiveness in few hours, these campaigns are distributed via SMS or email, urging the potential victim to perform a “quick action”.\nA SMS used to distribute a phishing campaign. Picture from gov.uk\nIn order to make it more difficult for threat actors, I decided to work on a proof of concept of a tool that aims to pollute the data of phishing victims with random information, so that actors will have to either validate the data to discover which are authentic, or discard the database.\nBackground For this proof of concept, I choose to target a particular phishing kit, which I have reported multiple times:\nThe target of this poc: a phishing page for the Italian bank Intesa Sanpaolo\nThis kit is particularly suitable for this experiment, because it exposes the logs of the victims in a text file that is often left unprotected online.\nThis poses an additional security risk for the victims, because their credentials are not only in the hands of the actor who deployed the kit, but are also potentially accessible to other actors that can crawl the web for phishing kits alredy deployed by others.\nHowever, for the sake of this experiment, having the logs exposed makes it easier to verify if the code works as expected.\nThe phishing page In this case, we don’t have access to the PHP code of the kit, because I couldn’t find the zip in these domains. However I would be interested in analyzing it, so if you have it, please let me know!\nEven if we don’t have access to the PHP, we have everything we need in the HTML of the phishing page. Here is the form for entering the credentials:\n\u003cdiv\u003e \u003cform id=\"command\" class=\"form-group\" action=\"/core/login.php\" method=\"post\" autocomplete=\"off\"\u003e\u003cbr /\u003e \u003cp\u003e\u003ch2\u003e\u003clabel for=\"camp1\"\u003eCodice Titolare\u003c/label\u003e\u003c/h2\u003e\u003c/p\u003e \u003cinput class = \"form-control\" type=\"number\" name=\"codice\" id=\"_camp1\" required tabindex=\"1\" value=\"\" minlength=\"4\" maxlength=\"10\"\u003e\u003cbr /\u003e \u003cp\u003e\u003cstrong\u003e\u003clabel for=\"camp2\"\u003ePIN\u003c/label\u003e\u003c/strong\u003e\u003c/p\u003e \u003cinput class=\"form-control\" type=\"number\" type=\"password\" name=\"password\" id=\"_camp2\" required tabindex=\"2\" value=\"\"\u003e\u003cbr /\u003e \u003cp\u003e\u003cstrong\u003e \u003clabel for=\"camp3\"\u003eNumero di telefono\u003c/label\u003e\u003c/strong\u003e\u003c/p\u003e \u003cinput class=\"form-control\" type=\"number\" name=\"cellulare\" id=\"_camp3\" required tabindex=\"3\" value=\"\"\u003e\u003cbr /\u003e \u003cp\u003e\u003cstrong\u003e\u003clabel for=\"camp4\"\u003eSe sei cliente Fideuram seleziona la casella in basso\u003c/label\u003e\u003c/strong\u003e \u003cinput class=\"form-check-label\" type=\"checkbox\" name=\"fideuram\" id=\"_camp4\" value=\"Si\" tabindex=\"5\"\u003e\u003c/p\u003e\u003cbr /\u003e\u003cbr /\u003e \u003cbutton style=\"background-color: green;font-size : 20px;\" type=\"submit\" class=\"btn btn-primary btn-lg btn-block\"\u003eENTRA\u003c/button\u003e\u003c/form\u003e \u003c/div\u003e The action attribute of the form specifies where the POST request is sent, in this case to /core/login.php. Using this address and the attributes name and type of the input fields, we can easily make a post with cURL:\n$ curl -d \"codice=123\u0026password=123\u0026cellulare=12345678\" \\ -X POST https://www.riscontrotitolare.com/core/login.php Please note that this kit is also logging the IP address of these requests, so be sure to run the line above behind a proxy or a VPN.\nThe POST made with cURL worked!\nAfter being sure that the POST request made it with cURL worked, we can start writing the code.\nPhishFlood: writing the code The idea of phishflood is to have a program that:\nautomatically detects the required attributes of the form and of the input fields makes POST requests with random data which are non easily distinguishable from authentic data uses various proxies to make requests (to hide our IP) wait a random time between two requests, to not create an obvious time frame of when the program was executed makes use of the goroutines to improve efficiency For the first point, I decided to use goquery to detect the form, get the content of the action attribute, and the name and type attributes of the other input parameters.\nFor brevity reasons, I excluded from the code below all the lines for handling possible errors.\nfunc getPostData(phishingUrl string, parsedProxies []string) (string, []string, []string) { postAction := \"\" var inputNames []string var inputTypes []string var myClient *http.Client // make post request using proxy if len(parsedProxies) != 0 { proxyURL, err := url.Parse(parsedProxies[0]) // be sure to handle the err.. myClient = \u0026http.Client{Timeout: 15 * time.Second, Transport: \u0026http.Transport{Proxy: http.ProxyURL(proxyURL)}} } else { myClient = \u0026http.Client{Timeout: 15 * time.Second } req, err := http.NewRequest(\"GET\", phishingUrl, nil) resp, err := myClient.Do(req) defer resp.Body.Close() if resp.StatusCode != 200 { fmt.Printf(\"status code error: %d %s \\n\", resp.StatusCode, resp.Status) os.Exit(1) } // Load the HTML document and find the form with goquery doc, err := goquery.NewDocumentFromReader(resp.Body) doc.Find(\"form\").Each(func(i int, form *goquery.Selection) { action, actionOk := form.Attr(\"action\") if actionOk { form.Find(\"input\").Each(func(i int, input *goquery.Selection) { nameattr, nameOk := input.Attr(\"name\") typeattr, typeOk := input.Attr(\"type\") // find input with name and attributes if actionOk \u0026\u0026 nameOk \u0026\u0026 typeOk { inputNames = append(inputNames, nameattr) inputTypes = append(inputTypes, typeattr) u, err := url.Parse(phishingUrl) // create full url for path where to submit the form u.Path = path.Join(u.Path, action) postAction = u.String() } }) }}) return postAction, inputNames, inputTypes } The beginning of the main function of our code takes the URL of the phishing page in input, calls the function getPostData (mentioned above) and prints the results:\nfunc main() { // check we have one input provided if len(os.Args) != 2 { fmt.Fprintf(os.Stderr, \"Please specify one URL: ./phishflood *URL* \\n\") os.Exit(1) } // take a url from input phishingUrl := os.Args[1] // validate url provided if _, err := url.ParseRequestURI(phishingUrl); err != nil { fmt.Fprintf(os.Stderr, \"It was not possible to parse the URL\\n\") os.Exit(1) } // navigate to it and print findings postAction, inputNames, inputTypes := getPostData(phishingUrl) fmt.Printf(\"[!] Found a form with action: %s \\n\" + \"[!] Input fields names found: %v\" + \"\\n[!] Input fields types found: %v\\n\\n\", postAction, inputNames, inputTypes) The rest of the main uses 10 goroutines to make the requests concurrently (well, almost concurrently because we have a random delay), and a channel ( ch ) to communicate when a goroutine finished.\n// set random seed rand.Seed(time.Now().UnixNano()) // create channel used for goroutines ch := make(chan string) // specify the number of routines to use routines := 10 // start goroutines for i := 0; i \u003c routines; i++ { // create wait for a random number of seconds between 2 and 10 w := int(rand.Intn(10000-2000) + 2000) time.Sleep(time.Duration(w) * time.Millisecond) // send requests with fake data go flood(i, postAction, inputNames, inputTypes, ch) } // when POST request is completed, print the status code from the channel for i := 0; i \u003c routines; i++ { fmt.Println(\u003c-ch) } } A small delay between 10 and 2 seconds is introduced in the for loop. Ideally, this delay should be higher, to not make it obvious that these POST requests were automated.\nThe flood function needs a list of proxy addresses (px in the code below), which are used to make the requests without showing our IP address in the kit. The fake data which are going to be submitted are contained in vals and populated in a not sophisticated way: since all the input types are number for this kit, it is sufficient to create random numbers between a sufficiently long interval.\nIn Go, it is possible to create random number between an interval in the following way:\nrandomnumber := rand.Intn( max - min ) + min The input field with the name cellulare needed particular attention: “cellulare” stands for “mobile phone” in italian, so the interval for the random generation is a bit more complicated.\nAfter the POST request, the status code is sent to the channel, and the goroutine terminate its execution.\nfunc flood(i int, postAction string, inputNames []string, inputTypes []string, ch chan\u003c- string) { // make post request using proxy proxyURL, _ := url.Parse(px[i%len(px)]) if err != nil { fmt.Fprintf(os.Stderr, \"Error parsing the proxy address\\n\") os.Exit(1) } myClient := \u0026http.Client{Timeout: 15 * time.Second, Transport: \u0026http.Transport{Proxy: http.ProxyURL(proxyURL)}} // generate fake data vals := url.Values{} for i, valName := range inputNames { // \"cellulare\" is \"mobile phone\" in italian, so we // have a particular interval to make it realistic if valName == \"cellulare\" { val := rand.Intn(3499999999-3200000000) + 3200000000 vals.Set(valName, fmt.Sprintf(\"%d\", val)) // these are generic numbers } else if inputTypes[i] == \"number\" { val := rand.Intn(99999999-10000000)+10000000 vals.Set(valName, fmt.Sprintf(\"%d\",val)) } } // make the POST request resp, err := http.PostForm(postAction, vals) // print error if err != nil { fmt.Println(err) } else { // send to the channel the status code of the POST ch \u003c- fmt.Sprintf(\"Request #%d with these parameters {codice: %s,\", \"cellulare: %s, password: %s} returned the following status code:\", \"%d %s.\", i+1, vals.Get(\"codice\"), vals.Get(\"cellulare\"), vals.Get(\"password\"), resp.StatusCode, http.StatusText(resp.StatusCode)) } } Results and possible improvements If we run the code above specifying a URL, we should see something like this:\nOutput of phishflood\nDepending on the status of the proxies, we may have some timeout errors. However, when I checked the logs of the kit I was able to find our fake data:\nLogs on the phishing page\nThe main limitation of this poc is that is only compatible with these kinds of phishing kits. Two possible improvements are:\nFake data generation for different types of input fields. Many phishing kits are targeting email credentials, or credit cards number, the library faker could help in the generation of these data. Handling multiple forms. Some phishing kits ask the user to fill different forms, and sometimes the second form is accessible only if the first one is submitted. A possible approach to overcome this would be to continue submitting form with fake data as long as there is not a redirection or no more forms are found. Conclusion In this post we saw how to create a proof of concept to pollute with fake data the credentials stolen with a phishing kit. There is a lot of space for improvements, but, after checking the logs of the kit, I consider the proof of concept successful as it is.\nIf you want to play around with phishflood you can use this GitHub repo, I have organized the code and added some improvements. Feel free to let me know what features could be added.\n",
  "wordCount" : "1709",
  "inLanguage": "en",
  "datePublished": "2021-01-31T00:00:00Z",
  "dateModified": "2021-01-31T00:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://andpalmier.com/posts/flooding-phishing-kits/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "andpalmier",
    "logo": {
      "@type": "ImageObject",
      "url": "https://andpalmier.com/images/favicon-32x32.png"
    }
  }
}
</script>
</head>

<body class=" dark" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://andpalmier.com/" accesskey="h" title="andpalmier (Alt + H)">andpalmier</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://andpalmier.com/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="https://andpalmier.com/about/" title="About">
                    <span>About</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      PhishFlood: a poc for flooding phishing kits
    </h1>
    <div class="post-meta"><span title='2021-01-31 00:00:00 +0000 UTC'>January 31, 2021</span>&nbsp;·&nbsp;9 min

</div>
  </header> 
  <div class="post-content"><figure class="align-center ">
    <img loading="lazy" src="https://steamuserimages-a.akamaihd.net/ugc/2418873130670778483/414245F5E27783EC5F84ABBBF9E5840B641007DC/#center"
         alt="phishflood"/> 
</figure>

<h2 id="introduction">Introduction<a hidden class="anchor" aria-hidden="true" href="#introduction">#</a></h2>
<p>If you use Twitter to stay up to date with the latest security news, you may have noticed a community of researchers reporting phishing websites and scam pages everyday (if you want to follow them, <em>phishunt.io</em> have a good list of profiles in their <a href="https://phishunt.io/community/" target="_blank" rel="noopener">community section</a>).</p>
<p>Unfortunately, reporting these websites is not always very effective. In many cases the phishing pages are removed only after 24-48 hours of being reported, and at that point they may have already stolen credentials from a lot of victims.
In order to maximize their effectiveness in few hours, these campaigns are distributed via SMS or email, urging the potential victim to perform a &ldquo;quick action&rdquo;.</p>
<figure class="align-center ">
    <img loading="lazy" src="https://assets.publishing.service.gov.uk/government/uploads/system/uploads/image_data/file/97661/DCDT-11434.JPG#center"
         alt="smishing example"/> <figcaption>
            <p>A SMS used to distribute a phishing campaign. <a href="https://www.gov.uk/government/publications/phishing-and-bogus-emails-hm-revenue-and-customs-examples/phishing-emails-and-bogus-contact-hm-revenue-and-customs-examples" target="_blank" rel="noopener">Picture from gov.uk</a></p>
        </figcaption>
</figure>

<p>In order to make it more difficult for threat actors, I decided to work on a proof of concept of a tool that aims to pollute the data of phishing victims with random information, so that actors will have to either validate the data to discover which are authentic, or discard the database.</p>
<h2 id="background">Background<a hidden class="anchor" aria-hidden="true" href="#background">#</a></h2>
<p>For this proof of concept, I choose to target a particular phishing kit, which I have reported multiple times:</p>
<figure class="align-center ">
    <img loading="lazy" src="/images/posts/phishflood/phishing-kit.png#center"
         alt="Intesa SanPaolo phishing"/> <figcaption>
            <p>The target of this poc: a phishing page for the Italian bank Intesa Sanpaolo</p>
        </figcaption>
</figure>

<p>This kit is particularly suitable for this experiment, because it exposes the logs of the victims in a text file that is often left unprotected online.</p>
<p>This poses an additional security risk for the victims, because their credentials are not only in the hands of the actor who deployed the kit, but are also potentially accessible to other actors that can crawl the web for phishing kits alredy deployed by others.</p>
<p>However, for the sake of this experiment, having the logs exposed makes it easier to verify if the code works as expected.</p>
<h2 id="the-phishing-page">The phishing page<a hidden class="anchor" aria-hidden="true" href="#the-phishing-page">#</a></h2>
<p>In this case, we don&rsquo;t have access to the PHP code of the kit, because I couldn&rsquo;t find the zip in these domains. However I would be interested in analyzing it, so if you have it, please let me know!</p>
<p>Even if we don&rsquo;t have access to the PHP, we have everything we need in the HTML of the phishing page. Here is the form for entering the credentials:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">form</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;command&#34;</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;form-group&#34;</span> <span class="na">action</span><span class="o">=</span><span class="s">&#34;/core/login.php&#34;</span> <span class="na">method</span><span class="o">=</span><span class="s">&#34;post&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="na">autocomplete</span><span class="o">=</span><span class="s">&#34;off&#34;</span><span class="p">&gt;&lt;</span><span class="nt">br</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;&lt;</span><span class="nt">h2</span><span class="p">&gt;&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">&#34;camp1&#34;</span><span class="p">&gt;</span>Codice Titolare<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;&lt;/</span><span class="nt">h2</span><span class="p">&gt;&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="p">&lt;</span><span class="nt">input</span> <span class="na">class </span><span class="o">=</span> <span class="s">&#34;form-control&#34;</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;number&#34;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;codice&#34;</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;_camp1&#34;</span>
</span></span><span class="line"><span class="cl">	    <span class="na">required</span> <span class="na">tabindex</span><span class="o">=</span><span class="s">&#34;1&#34;</span> <span class="na">value</span><span class="o">=</span><span class="s">&#34;&#34;</span> <span class="na">minlength</span><span class="o">=</span><span class="s">&#34;4&#34;</span> <span class="na">maxlength</span><span class="o">=</span><span class="s">&#34;10&#34;</span><span class="p">&gt;&lt;</span><span class="nt">br</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;&lt;</span><span class="nt">strong</span><span class="p">&gt;&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">&#34;camp2&#34;</span><span class="p">&gt;</span>PIN<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;&lt;/</span><span class="nt">strong</span><span class="p">&gt;&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="p">&lt;</span><span class="nt">input</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;form-control&#34;</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;number&#34;</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;password&#34;</span>
</span></span><span class="line"><span class="cl">	   <span class="na">name</span><span class="o">=</span><span class="s">&#34;password&#34;</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;_camp2&#34;</span> <span class="na">required</span> <span class="na">tabindex</span><span class="o">=</span><span class="s">&#34;2&#34;</span> <span class="na">value</span><span class="o">=</span><span class="s">&#34;&#34;</span><span class="p">&gt;&lt;</span><span class="nt">br</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;&lt;</span><span class="nt">strong</span><span class="p">&gt;</span> <span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">&#34;camp3&#34;</span><span class="p">&gt;</span>Numero di telefono<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;&lt;/</span><span class="nt">strong</span><span class="p">&gt;&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="p">&lt;</span><span class="nt">input</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;form-control&#34;</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;number&#34;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;cellulare&#34;</span>
</span></span><span class="line"><span class="cl">	    <span class="na">id</span><span class="o">=</span><span class="s">&#34;_camp3&#34;</span> <span class="na">required</span> <span class="na">tabindex</span><span class="o">=</span><span class="s">&#34;3&#34;</span> <span class="na">value</span><span class="o">=</span><span class="s">&#34;&#34;</span><span class="p">&gt;&lt;</span><span class="nt">br</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;&lt;</span><span class="nt">strong</span><span class="p">&gt;&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">&#34;camp4&#34;</span><span class="p">&gt;</span>Se sei cliente Fideuram seleziona
</span></span><span class="line"><span class="cl">	    la casella in basso<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;&lt;/</span><span class="nt">strong</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="p">&lt;</span><span class="nt">input</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;form-check-label&#34;</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;checkbox&#34;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;fideuram&#34;</span>
</span></span><span class="line"><span class="cl">	    <span class="na">id</span><span class="o">=</span><span class="s">&#34;_camp4&#34;</span> <span class="na">value</span><span class="o">=</span><span class="s">&#34;Si&#34;</span> <span class="na">tabindex</span><span class="o">=</span><span class="s">&#34;5&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">p</span><span class="p">&gt;&lt;</span><span class="nt">br</span> <span class="p">/&gt;&lt;</span><span class="nt">br</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="p">&lt;</span><span class="nt">button</span> <span class="na">style</span><span class="o">=</span><span class="s">&#34;background-color: green;font-size : 20px;&#34;</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;submit&#34;</span>
</span></span><span class="line"><span class="cl">	    <span class="na">class</span><span class="o">=</span><span class="s">&#34;btn btn-primary btn-lg btn-block&#34;</span><span class="p">&gt;</span>ENTRA<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span></code></pre></div><p>The <code>action</code> attribute of the form specifies where the POST request is sent, in this case to <code>/core/login.php</code>. Using this address and the attributes <code>name</code> and <code>type</code> of the input fields, we can easily make a post with cURL:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ curl -d <span class="s2">&#34;codice=123&amp;password=123&amp;cellulare=12345678&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -X POST https://www.riscontrotitolare.com/core/login.php
</span></span></code></pre></div><p>Please note that this kit is also logging the IP address of these requests, so be sure to run the line above behind a proxy or a VPN.</p>
<figure class="align-center ">
    <img loading="lazy" src="/images/posts/phishflood/logs-curl.png#center"
         alt="testing injection with curl"/> <figcaption>
            <p>The POST made with cURL worked!</p>
        </figcaption>
</figure>

<p>After being sure that the POST request made it with cURL worked, we can start writing the code.</p>
<h2 id="phishflood-writing-the-code">PhishFlood: writing the code<a hidden class="anchor" aria-hidden="true" href="#phishflood-writing-the-code">#</a></h2>
<p>The idea of <code>phishflood</code> is to have a program that:</p>
<ul>
<li>automatically detects the required attributes of the form and of the input fields</li>
<li>makes POST requests with random data which are non easily distinguishable from authentic data</li>
<li>uses various proxies to make requests (to hide our IP)</li>
<li>wait a random time between two requests, to not create an obvious time frame of when the program was executed</li>
<li>makes use of the goroutines to improve efficiency</li>
</ul>
<p>For the first point, I decided to use <a href="https://godoc.org/github.com/PuerkitoBio/goquery" target="_blank" rel="noopener">goquery</a> to detect the <code>form</code>, get the content of the <code>action</code> attribute, and the <code>name</code> and <code>type</code> attributes of the other input parameters.</p>
<p>For brevity reasons, I excluded from the code below all the lines for handling possible errors.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">getPostData</span><span class="p">(</span><span class="nx">phishingUrl</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">parsedProxies</span> <span class="p">[]</span><span class="kt">string</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">(</span><span class="kt">string</span><span class="p">,</span> <span class="p">[]</span><span class="kt">string</span><span class="p">,</span> <span class="p">[]</span><span class="kt">string</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nx">postAction</span> <span class="o">:=</span> <span class="s">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">inputNames</span> <span class="p">[]</span><span class="kt">string</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">inputTypes</span> <span class="p">[]</span><span class="kt">string</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">myClient</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Client</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// make post request using proxy
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nx">parsedProxies</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">proxyURL</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">url</span><span class="p">.</span><span class="nf">Parse</span><span class="p">(</span><span class="nx">parsedProxies</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// be sure to handle the err..
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="nx">myClient</span> <span class="p">=</span> <span class="o">&amp;</span><span class="nx">http</span><span class="p">.</span><span class="nx">Client</span><span class="p">{</span><span class="nx">Timeout</span><span class="p">:</span> <span class="mi">15</span> <span class="o">*</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Second</span><span class="p">,</span> <span class="nx">Transport</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">	    <span class="o">&amp;</span><span class="nx">http</span><span class="p">.</span><span class="nx">Transport</span><span class="p">{</span><span class="nx">Proxy</span><span class="p">:</span> <span class="nx">http</span><span class="p">.</span><span class="nf">ProxyURL</span><span class="p">(</span><span class="nx">proxyURL</span><span class="p">)}}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="nx">myClient</span> <span class="p">=</span> <span class="o">&amp;</span><span class="nx">http</span><span class="p">.</span><span class="nx">Client</span><span class="p">{</span><span class="nx">Timeout</span><span class="p">:</span> <span class="mi">15</span> <span class="o">*</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Second</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nx">req</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">http</span><span class="p">.</span><span class="nf">NewRequest</span><span class="p">(</span><span class="s">&#34;GET&#34;</span><span class="p">,</span> <span class="nx">phishingUrl</span><span class="p">,</span> <span class="kc">nil</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nx">resp</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">myClient</span><span class="p">.</span><span class="nf">Do</span><span class="p">(</span><span class="nx">req</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">defer</span> <span class="nx">resp</span><span class="p">.</span><span class="nx">Body</span><span class="p">.</span><span class="nf">Close</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nx">resp</span><span class="p">.</span><span class="nx">StatusCode</span> <span class="o">!=</span> <span class="mi">200</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;status code error: %d %s \n&#34;</span><span class="p">,</span> <span class="nx">resp</span><span class="p">.</span><span class="nx">StatusCode</span><span class="p">,</span> <span class="nx">resp</span><span class="p">.</span><span class="nx">Status</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">os</span><span class="p">.</span><span class="nf">Exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Load the HTML document and find the form with goquery
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">doc</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">goquery</span><span class="p">.</span><span class="nf">NewDocumentFromReader</span><span class="p">(</span><span class="nx">resp</span><span class="p">.</span><span class="nx">Body</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nx">doc</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span><span class="s">&#34;form&#34;</span><span class="p">).</span><span class="nf">Each</span><span class="p">(</span><span class="kd">func</span><span class="p">(</span><span class="nx">i</span> <span class="kt">int</span><span class="p">,</span> <span class="nx">form</span> <span class="o">*</span><span class="nx">goquery</span><span class="p">.</span><span class="nx">Selection</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">action</span><span class="p">,</span> <span class="nx">actionOk</span> <span class="o">:=</span> <span class="nx">form</span><span class="p">.</span><span class="nf">Attr</span><span class="p">(</span><span class="s">&#34;action&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nx">actionOk</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">form</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span><span class="s">&#34;input&#34;</span><span class="p">).</span><span class="nf">Each</span><span class="p">(</span><span class="kd">func</span><span class="p">(</span><span class="nx">i</span> <span class="kt">int</span><span class="p">,</span> <span class="nx">input</span> <span class="o">*</span><span class="nx">goquery</span><span class="p">.</span><span class="nx">Selection</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	    <span class="nx">nameattr</span><span class="p">,</span> <span class="nx">nameOk</span> <span class="o">:=</span> <span class="nx">input</span><span class="p">.</span><span class="nf">Attr</span><span class="p">(</span><span class="s">&#34;name&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	    <span class="nx">typeattr</span><span class="p">,</span> <span class="nx">typeOk</span> <span class="o">:=</span> <span class="nx">input</span><span class="p">.</span><span class="nf">Attr</span><span class="p">(</span><span class="s">&#34;type&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	    <span class="c1">// find input with name and attributes
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	    <span class="k">if</span> <span class="nx">actionOk</span> <span class="o">&amp;&amp;</span> <span class="nx">nameOk</span> <span class="o">&amp;&amp;</span> <span class="nx">typeOk</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">inputNames</span> <span class="p">=</span> <span class="nb">append</span><span class="p">(</span><span class="nx">inputNames</span><span class="p">,</span> <span class="nx">nameattr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="nx">inputTypes</span> <span class="p">=</span> <span class="nb">append</span><span class="p">(</span><span class="nx">inputTypes</span><span class="p">,</span> <span class="nx">typeattr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="nx">u</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">url</span><span class="p">.</span><span class="nf">Parse</span><span class="p">(</span><span class="nx">phishingUrl</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// create full url for path where to submit the form
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="nx">u</span><span class="p">.</span><span class="nx">Path</span> <span class="p">=</span> <span class="nx">path</span><span class="p">.</span><span class="nf">Join</span><span class="p">(</span><span class="nx">u</span><span class="p">.</span><span class="nx">Path</span><span class="p">,</span> <span class="nx">action</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="nx">postAction</span> <span class="p">=</span> <span class="nx">u</span><span class="p">.</span><span class="nf">String</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">	    <span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">})</span>
</span></span><span class="line"><span class="cl">    <span class="p">}})</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">postAction</span><span class="p">,</span> <span class="nx">inputNames</span><span class="p">,</span> <span class="nx">inputTypes</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>The beginning of the <code>main</code> function of our code takes the URL of the phishing page in input, calls the function <code>getPostData</code> (mentioned above) and prints the results:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// check we have one input provided
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nx">os</span><span class="p">.</span><span class="nx">Args</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Fprintf</span><span class="p">(</span><span class="nx">os</span><span class="p">.</span><span class="nx">Stderr</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">	    <span class="s">&#34;Please specify one URL: ./phishflood *URL* \n&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">os</span><span class="p">.</span><span class="nf">Exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// take a url from input
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">phishingUrl</span> <span class="o">:=</span> <span class="nx">os</span><span class="p">.</span><span class="nx">Args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// validate url provided
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">url</span><span class="p">.</span><span class="nf">ParseRequestURI</span><span class="p">(</span><span class="nx">phishingUrl</span><span class="p">);</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Fprintf</span><span class="p">(</span><span class="nx">os</span><span class="p">.</span><span class="nx">Stderr</span><span class="p">,</span> <span class="s">&#34;It was not possible to parse the URL\n&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">os</span><span class="p">.</span><span class="nf">Exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// navigate to it and print findings
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">postAction</span><span class="p">,</span> <span class="nx">inputNames</span><span class="p">,</span> <span class="nx">inputTypes</span> <span class="o">:=</span> <span class="nf">getPostData</span><span class="p">(</span><span class="nx">phishingUrl</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;[!] Found a form with action: %s \n&#34;</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;[!] Input fields names found: %v&#34;</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;\n[!] Input fields types found: %v\n\n&#34;</span><span class="p">,</span> <span class="nx">postAction</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">	<span class="nx">inputNames</span><span class="p">,</span> <span class="nx">inputTypes</span><span class="p">)</span>
</span></span></code></pre></div><p>The rest of the <code>main</code> uses 10 goroutines to make the requests concurrently (<em>well, almost concurrently because we have a random delay</em>), and a channel ( <code>ch</code> ) to communicate when a goroutine finished.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl">    <span class="c1">// set random seed
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">rand</span><span class="p">.</span><span class="nf">Seed</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nf">Now</span><span class="p">().</span><span class="nf">UnixNano</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// create channel used for goroutines
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">ch</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="kd">chan</span> <span class="kt">string</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// specify the number of routines to use
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">routines</span> <span class="o">:=</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// start goroutines
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">for</span> <span class="nx">i</span> <span class="o">:=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="p">&lt;</span> <span class="nx">routines</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="c1">// create wait for a random number of seconds between 2 and 10
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="nx">w</span> <span class="o">:=</span> <span class="nb">int</span><span class="p">(</span><span class="nx">rand</span><span class="p">.</span><span class="nf">Intn</span><span class="p">(</span><span class="mi">10000</span><span class="o">-</span><span class="mi">2000</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2000</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">time</span><span class="p">.</span><span class="nf">Sleep</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nf">Duration</span><span class="p">(</span><span class="nx">w</span><span class="p">)</span> <span class="o">*</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Millisecond</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="c1">// send requests with fake data
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="k">go</span> <span class="nf">flood</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="nx">postAction</span><span class="p">,</span> <span class="nx">inputNames</span><span class="p">,</span> <span class="nx">inputTypes</span><span class="p">,</span> <span class="nx">ch</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// when POST request is completed, print the status code from the channel
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">for</span> <span class="nx">i</span> <span class="o">:=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="p">&lt;</span> <span class="nx">routines</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="o">&lt;-</span><span class="nx">ch</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>A small delay between 10 and 2 seconds is introduced in the for loop. Ideally, this delay should be higher, to not make it obvious that these POST requests were automated.</p>
<p>The <code>flood</code> function needs a list of proxy addresses (<code>px</code> in the code below), which are used to make the requests without showing our IP address in the kit.
The fake data which are going to be submitted are contained in <code>vals</code> and populated in a not sophisticated way: since all the input types are <code>number</code> for this kit, it is sufficient to create random numbers between a sufficiently long interval.</p>
<p>In Go, it is possible to create random number between an interval in the following way:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="nx">randomnumber</span> <span class="o">:=</span> <span class="nx">rand</span><span class="p">.</span><span class="nf">Intn</span><span class="p">(</span> <span class="nx">max</span> <span class="o">-</span> <span class="nx">min</span> <span class="p">)</span> <span class="o">+</span> <span class="nx">min</span>
</span></span></code></pre></div><p>The input field with the name <code>cellulare</code> needed particular attention: <em>&ldquo;cellulare</em>&rdquo; stands for <em>&ldquo;mobile phone&rdquo;</em> in italian, so the interval for the random generation is a bit more complicated.</p>
<p>After the POST request, the status code is sent to the channel, and the goroutine terminate its execution.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">flood</span><span class="p">(</span><span class="nx">i</span> <span class="kt">int</span><span class="p">,</span> <span class="nx">postAction</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">inputNames</span> <span class="p">[]</span><span class="kt">string</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">inputTypes</span> <span class="p">[]</span><span class="kt">string</span><span class="p">,</span> <span class="nx">ch</span> <span class="kd">chan</span><span class="o">&lt;-</span> <span class="kt">string</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// make post request using proxy
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">proxyURL</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">url</span><span class="p">.</span><span class="nf">Parse</span><span class="p">(</span><span class="nx">px</span><span class="p">[</span><span class="nx">i</span><span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="nx">px</span><span class="p">)])</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Fprintf</span><span class="p">(</span><span class="nx">os</span><span class="p">.</span><span class="nx">Stderr</span><span class="p">,</span> <span class="s">&#34;Error parsing the proxy address\n&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">os</span><span class="p">.</span><span class="nf">Exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nx">myClient</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="nx">http</span><span class="p">.</span><span class="nx">Client</span><span class="p">{</span><span class="nx">Timeout</span><span class="p">:</span> <span class="mi">15</span> <span class="o">*</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Second</span><span class="p">,</span> <span class="nx">Transport</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">	<span class="o">&amp;</span><span class="nx">http</span><span class="p">.</span><span class="nx">Transport</span><span class="p">{</span><span class="nx">Proxy</span><span class="p">:</span> <span class="nx">http</span><span class="p">.</span><span class="nf">ProxyURL</span><span class="p">(</span><span class="nx">proxyURL</span><span class="p">)}}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// generate fake data
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">vals</span> <span class="o">:=</span> <span class="nx">url</span><span class="p">.</span><span class="nx">Values</span><span class="p">{}</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">valName</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">inputNames</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="c1">// &#34;cellulare&#34; is &#34;mobile phone&#34; in italian, so we
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="c1">// have a particular interval to make it realistic
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="k">if</span> <span class="nx">valName</span> <span class="o">==</span> <span class="s">&#34;cellulare&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	    <span class="nx">val</span> <span class="o">:=</span> <span class="nx">rand</span><span class="p">.</span><span class="nf">Intn</span><span class="p">(</span><span class="mi">3499999999</span><span class="o">-</span><span class="mi">3200000000</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3200000000</span>
</span></span><span class="line"><span class="cl">	    <span class="nx">vals</span><span class="p">.</span><span class="nf">Set</span><span class="p">(</span><span class="nx">valName</span><span class="p">,</span> <span class="nx">fmt</span><span class="p">.</span><span class="nf">Sprintf</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span> <span class="nx">val</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	    <span class="c1">// these are generic numbers
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="nx">inputTypes</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#34;number&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	    <span class="nx">val</span> <span class="o">:=</span> <span class="nx">rand</span><span class="p">.</span><span class="nf">Intn</span><span class="p">(</span><span class="mi">99999999</span><span class="o">-</span><span class="mi">10000000</span><span class="p">)</span><span class="o">+</span><span class="mi">10000000</span>
</span></span><span class="line"><span class="cl">	    <span class="nx">vals</span><span class="p">.</span><span class="nf">Set</span><span class="p">(</span><span class="nx">valName</span><span class="p">,</span> <span class="nx">fmt</span><span class="p">.</span><span class="nf">Sprintf</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span><span class="nx">val</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// make the POST request
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">resp</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">http</span><span class="p">.</span><span class="nf">PostForm</span><span class="p">(</span><span class="nx">postAction</span><span class="p">,</span> <span class="nx">vals</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// print error
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="c1">// send to the channel the status code of the POST
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="nx">ch</span> <span class="o">&lt;-</span> <span class="nx">fmt</span><span class="p">.</span><span class="nf">Sprintf</span><span class="p">(</span><span class="s">&#34;Request #%d with these parameters {codice: %s,&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">	    <span class="s">&#34;cellulare: %s, password: %s} returned the following status code:&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">	    <span class="s">&#34;%d %s.&#34;</span><span class="p">,</span> <span class="nx">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nx">vals</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="s">&#34;codice&#34;</span><span class="p">),</span> <span class="nx">vals</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="s">&#34;cellulare&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">	    <span class="nx">vals</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="s">&#34;password&#34;</span><span class="p">),</span> <span class="nx">resp</span><span class="p">.</span><span class="nx">StatusCode</span><span class="p">,</span> <span class="nx">http</span><span class="p">.</span><span class="nf">StatusText</span><span class="p">(</span><span class="nx">resp</span><span class="p">.</span><span class="nx">StatusCode</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h2 id="results-and-possible-improvements">Results and possible improvements<a hidden class="anchor" aria-hidden="true" href="#results-and-possible-improvements">#</a></h2>
<p>If we run the code above specifying a URL, we should see something like this:</p>
<figure class="align-center ">
    <img loading="lazy" src="/images/posts/phishflood/phishflood.png#center"
         alt="output of phishflood"/> <figcaption>
            <p>Output of phishflood</p>
        </figcaption>
</figure>

<p>Depending on the status of the proxies, we may have some timeout errors. However, when I checked the logs of the kit I was able to find our fake data:</p>
<figure class="align-center ">
    <img loading="lazy" src="/images/posts/phishflood/logs.png#center"
         alt="logs of the phishing page"/> <figcaption>
            <p>Logs on the phishing page</p>
        </figcaption>
</figure>

<p>The main limitation of this poc is that is only compatible with these kinds of phishing kits. Two possible improvements are:</p>
<ul>
<li>Fake data generation for different types of input fields. Many phishing kits are targeting email credentials, or credit cards number, the library <a href="https://github.com/bxcodec/faker" target="_blank" rel="noopener">faker</a> could help in the generation of these data.</li>
<li>Handling multiple forms. Some phishing kits ask the user to fill different forms, and sometimes the second form is accessible only if the first one is submitted. A possible approach to overcome this would be to continue submitting form with fake data as long as there is not a redirection or no more forms are found.</li>
</ul>
<h2 id="conclusion">Conclusion<a hidden class="anchor" aria-hidden="true" href="#conclusion">#</a></h2>
<p>In this post we saw how to create a proof of concept to pollute with fake data the credentials stolen with a phishing kit.
There is a lot of space for improvements, but, after checking the logs of the kit, I consider the proof of concept successful as it is.</p>
<p>If you want to play around with <code>phishflood</code> you can use this <a href="https://github.com/andpalmier/phishflood/" target="_blank" rel="noopener">GitHub repo</a>, I have organized the code and added some improvements. Feel free to let me know what features could be added.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://andpalmier.com/tags/phishing/">Phishing</a></li>
      <li><a href="https://andpalmier.com/tags/go/">Go</a></li>
    </ul>
  </footer><script src="https://utteranc.es/client.js"
        repo="andpalmier/andpalmier.github.io"
        issue-term="og:title"
        label="comment"
        theme="preferred-color-scheme"
        crossorigin="anonymous"
        async>
</script>

</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2024 <a href="https://andpalmier.com/">andpalmier</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a><script src="https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js" integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S+Yti0U7QtuZvQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script>
const images = Array.from(document.querySelectorAll(".post-content img"));
images.forEach(img => {
  mediumZoom(img, {
    margin: 0,  
    scrollOffset: 40,  
    container: null,  
    template: null,  
    background: 'rgba(0, 0, 0, 0.8)'
  });
});
</script>


<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
