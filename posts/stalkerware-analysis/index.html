<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=light data-auto-appearance=true><head><meta charset=utf-8><meta http-equiv=content-language content="en"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=theme-color><title>Dissecting an Android stalkerware &#183; andpalmier's blog</title><meta name=title content="Dissecting an Android stalkerware &#183; andpalmier's blog"><meta name=description content="Analysis of an Italian stalkerware for Android"><meta name=keywords content="Malware Analysis,Incident Response,Privacy,"><link rel=canonical href=/posts/stalkerware-analysis/><meta name=author content="Andrea Palmieri (@andpalmier)"><link href=https://twitter.com/andpalmier rel=me><link href=https://bsky.app/profile/andpalmier.com rel=me><link href=https://github.com/andpalmier rel=me><link href=https://linkedin.com/in/andpalmier rel=me><link href=https://andpalmier.com/index.xml rel=me><meta property="og:url" content="/posts/stalkerware-analysis/"><meta property="og:site_name" content="andpalmier's blog"><meta property="og:title" content="Dissecting an Android stalkerware"><meta property="og:description" content="Deep dive technical analysis of an Android stalkerware app targeting Italian users. Discover its capabilities, permissions, and methods for spying on victims."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-01-11T00:00:00+00:00"><meta property="article:modified_time" content="2023-01-11T00:00:00+00:00"><meta property="article:tag" content="Malware Analysis"><meta property="article:tag" content="Incident Response"><meta property="article:tag" content="Privacy"><meta property="og:image" content="/posts/stalkerware-analysis/featured.webp"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/posts/stalkerware-analysis/featured.webp"><meta name=twitter:title content="Dissecting an Android stalkerware"><meta name=twitter:description content="Deep dive technical analysis of an Android stalkerware app targeting Italian users. Discover its capabilities, permissions, and methods for spying on victims."><link type=text/css rel=stylesheet href=/css/main.bundle.min.fc6219bc90238fee9b0eacb5e869ac71f831ea2c8a66ec98a69af1340225acff76762eaefad6190b02283789da553fedfc3768741dcddde07f10fc86e50eba49.css integrity="sha512-/GIZvJAjj+6bDqy16Gmscfgx6iyKZuyYpprxNAIlrP92di6u+tYZCwIoN4naVT/t/DdodB3N3eB/EPyG5Q66SQ=="><script type=text/javascript src=/js/appearance.min.6f41174b3a05b680820fe08cadbfa5fb7a7ca347b76a0955cdc68b9d8aca1ce24f0547e138cea33bcc7904d551a90afcb1cc7f2d9fe8557075d501419046c08c.js integrity="sha512-b0EXSzoFtoCCD+CMrb+l+3p8o0e3aglVzcaLnYrKHOJPBUfhOM6jO8x5BNVRqQr8scx/LZ/oVXB11QFBkEbAjA=="></script><script src=/lib/zoom/zoom.min.umd.a527109b68c082a70f3697716dd72a9d5aa8b545cf800cecbbc7399f2ca6f6e0ce3e431f2062b48bbfa47c9ea42822714060bef309be073f49b9c0e30d318d7b.js integrity="sha512-pScQm2jAgqcPNpdxbdcqnVqotUXPgAzsu8c5nyym9uDOPkMfIGK0i7+kfJ6kKCJxQGC+8wm+Bz9JucDjDTGNew=="></script><script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.0e2e7ce1e319db5369cd4badb8265de52c78d08df54617521bdac9c8cd335eea6133a82c83f9cb19baf67b8133335130e7e8ff7cfeaf7171016648dbf5a0578a.js integrity="sha512-Di584eMZ21NpzUutuCZd5Sx40I31RhdSG9rJyM0zXuphM6gsg/nLGbr2e4EzM1Ew5+j/fP6vcXEBZkjb9aBXig==" data-copy=Copy data-copied=Copied></script><script src=/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj+KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script><link rel=stylesheet href=/css/repo-cards.min.baaf512416b3dfd1e3a95a3f3d8d49e978f267c0efded75be3635a9fd4655746757c1277a3a67d77c541de80b862394f6aacc26b32d3c09fb016a071661253e9.css integrity="sha512-uq9RJBaz39HjqVo/PY1J6XjyZ8Dv3tdb42Nan9RlV0Z1fBJ3o6Z9d8VB3oC4YjlPaqzCazLTwJ+wFqBxZhJT6Q=="><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Posts","name":"Dissecting an Android stalkerware","headline":"Dissecting an Android stalkerware","description":"Deep dive technical analysis of an Android stalkerware app targeting Italian users. Discover its capabilities, permissions, and methods for spying on victims.","inLanguage":"en","url":"/posts/stalkerware-analysis/","author":{"@type":"Person","name":"Andrea Palmieri (@andpalmier)"},"copyrightYear":"2023","dateCreated":"2023-01-11T00:00:00\u002b00:00","datePublished":"2023-01-11T00:00:00\u002b00:00","dateModified":"2023-01-11T00:00:00\u002b00:00","keywords":["stalkerware analysis","Android security","spyware dissection","privacy research","mobile malware","stalkerware detection"],"mainEntityOfPage":"true","wordCount":"2611"}]</script></head><body class="flex flex-col h-screen m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32 text-lg bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral bf-scrollbar"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 pe-2 dark:text-primary-400">&darr;</span>
Skip to main content</a></div><div class=min-h-[148px]></div><div class="fixed inset-x-0 bg-neutral dark:bg-neutral-800 z-100"><div class="relative m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32"><div class="main-menu flex items-center w-full gap-2 p-1 pl-0"><a href=/ class="text-base font-medium truncate min-w-0 shrink">andpalmier&rsquo;s blog</a><div class="flex items-center ms-auto"><div class="hidden md:flex"><nav class="flex items-center gap-x-5 h-12"><a href=/ class="flex items-center bf-icon-color-hover" aria-label=Home title="andpalmier's blog"><span class="text-base font-medium break-normal">Home
</span></a><a href=/about/ class="flex items-center bf-icon-color-hover" aria-label=About title="Hey ðŸ‘‹"><span class="text-base font-medium break-normal">About
</span></a><button id=search-button aria-label=Search class="text-base bf-icon-color-hover" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button><div class="flex items-center"><button id=appearance-switcher aria-label="Dark mode switcher" type=button class="text-base bf-icon-color-hover"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></nav></div><div class="flex md:hidden"><div class="flex items-center h-14 gap-4"><button id=search-button-mobile aria-label=Search class="flex items-center justify-center bf-icon-color-hover" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span></button>
<button id=appearance-switcher-mobile type=button aria-label="Dark mode switcher" class="flex items-center justify-center text-neutral-900 hover:text-primary-600 dark:text-neutral-200 dark:hover:text-primary-400"><div class=dark:hidden><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="hidden dark:block"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button>
<input type=checkbox id=mobile-menu-toggle autocomplete=off class="hidden peer">
<label for=mobile-menu-toggle class="flex items-center justify-center cursor-pointer bf-icon-color-hover"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></label><div role=dialog aria-modal=true style=scrollbar-gutter:stable class="fixed inset-0 z-50 invisible overflow-y-auto px-6 py-20 opacity-0 transition-[opacity,visibility] duration-300 peer-checked:visible peer-checked:opacity-100 bg-neutral-50/97 dark:bg-neutral-900/99
bf-scrollbar"><label for=mobile-menu-toggle class="fixed end-8 top-5 flex items-center justify-center z-50 h-12 w-12 cursor-pointer select-none rounded-full bf-icon-color-hover border bf-border-color bf-border-color-hover bg-neutral-50 dark:bg-neutral-900"><span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></label><nav class="mx-auto max-w-md space-y-6"><div class=px-2><a href=/ aria-label=Home class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200"><span title="andpalmier's blog" class="text-2xl font-bold tracking-tight">Home</span></a></div><div class=px-2><a href=/about/ aria-label=About class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200"><span title="Hey ðŸ‘‹" class="text-2xl font-bold tracking-tight">About</span></a></div></nav></div></div></div></div></div><script>(function(){var t,n,e=document.querySelector(".main-menu");if(!e)return;t=window.location.pathname,n=e.querySelectorAll('a[href="'+t+'"]'),n.forEach(function(e){var t=e.querySelectorAll("span");t.forEach(function(e){e.classList.add("active")})})})()</script></div></div><div class="relative flex flex-col grow"><main id=main-content class=grow><article><figure><img src=/posts/stalkerware-analysis/featured_hu_6bec89a939913611.webp alt="Dissecting an Android stalkerware" loading=eager decoding=async fetchpriority=high class="w-full rounded-lg single_hero_round nozoom"></figure><header id=single_header class="mt-5 max-w-prose"><ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden"><li class=hidden><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/>andpalmier's blog</a><span class="px-1 text-primary-500">/</span></li><li class=inline><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/posts/>Posts</a><span class="px-1 text-primary-500">/</span></li><li class=hidden><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/posts/stalkerware-analysis/>Dissecting an Android stalkerware</a><span class="px-1 text-primary-500">/</span></li></ol><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">Dissecting an Android stalkerware</h1><div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime=2023-01-11T00:00:00+00:00>11 January 2023</time><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">13 mins</span></div><div class="flex flex-row flex-wrap items-center"></div></div><div class="flex author"><div class=place-self-center><div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">Author</div><div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">Andrea Palmieri (@andpalmier)</div><div class="text-sm text-neutral-700 dark:text-neutral-400">Deep dives into malware, phishing, and threat intelligence. Eternal noob and AS Roma fan.</div><div class="text-2xl sm:text-lg"><div class="flex flex-wrap text-neutral-400 dark:text-neutral-500"><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://twitter.com/andpalmier target=_blank aria-label=Twitter title=Twitter rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645.0 138.72-105.583 298.558-298.558 298.558-59.452.0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055.0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421.0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391.0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04.0-57.828 46.782-104.934 104.934-104.934 30.213.0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://bsky.app/profile/andpalmier.com target=_blank aria-label=Bluesky title=Bluesky rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 232.562c-21.183-41.196-78.868-117.97-132.503-155.834-51.378-36.272-70.978-29.987-83.828-24.181-14.872 6.72-17.577 29.554-17.577 42.988.0 13.433 7.365 110.138 12.169 126.281 15.873 53.336 72.376 71.358 124.413 65.574 2.66-.395 5.357-.759 8.089-1.097-2.68.429-5.379.796-8.089 1.097-76.259 11.294-143.984 39.085-55.158 137.972C201.224 526.527 237.424 403.67 256 341.379c18.576 62.291 39.972 180.718 150.734 83.983 83.174-83.983 22.851-126.674-53.408-137.969-2.71-.302-5.409-.667-8.089-1.096 2.732.337 5.429.702 8.089 1.096 52.037 5.785 108.54-12.239 124.413-65.574 4.804-16.142 12.169-112.847 12.169-126.281.0-13.434-2.705-36.267-17.577-42.988-12.85-5.806-32.45-12.09-83.829 24.181C334.868 114.595 277.183 191.366 256 232.562z"/></svg></span></span></a>
<a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://github.com/andpalmier target=_blank aria-label=Github title=Github rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://linkedin.com/in/andpalmier target=_blank aria-label=Linkedin title=Linkedin rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://andpalmier.com/index.xml target=_blank aria-label=Rss title=Rss rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M0 64C0 46.3 14.3 32 32 32c229.8.0 416 186.2 416 416 0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96 14.3 96 0 81.7.0 64zM128 416c0 35.3-28.7 64-64 64S0 451.3.0 416s28.7-64 64-64 64 28.7 64 64zM32 160c159.1.0 288 128.9 288 288 0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224-17.7.0-32-14.3-32-32s14.3-32 32-32z"/></svg></span></span></a></div></div></div></div><div class=mb-5></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="order-first lg:ms-auto px-0 lg:order-last lg:ps-8 lg:max-w-2xs"><div class="toc ps-5 print:hidden lg:sticky lg:top-[140px]"><details open id=TOCView class="toc-right mt-0 overflow-y-auto overscroll-contain bf-scrollbar rounded-lg -ms-5 ps-5 pe-2 hidden lg:block"><summary class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="min-w-[220px] py-2 border-dotted border-s-1 -ms-5 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#what-is-stalkerware>What is stalkerware?</a></li><li><a href=#the-website>The website</a></li><li><a href=#features>Features</a></li><li><a href=#analysis-of-the-sample>Analysis of the sample</a><ul><li><a href=#permissions-requested>Permissions requested</a></li><li><a href=#randomly-generated-package-name>Randomly generated package name</a></li><li><a href=#getting-the-pin>Getting the PIN</a></li><li><a href=#extracting-and-sending-media-files>Extracting and sending media files</a></li><li><a href=#screen-and-audio-recording>Screen and audio recording</a></li><li><a href=#gps-location>GPS location</a></li></ul></li><li><a href=#closing-remarks>Closing remarks</a><ul><li><a href=#mitre-attck-tactics-and-techniques>Mitre ATT&amp;CK Tactics And Techniques</a></li><li><a href=#yara>YARA</a></li><li><a href=#iocs>IOCs</a></li></ul></li></ul></nav></div></details><details class="toc-inside mt-0 overflow-hidden rounded-lg -ms-5 ps-5 lg:hidden"><summary class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="py-2 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#what-is-stalkerware>What is stalkerware?</a></li><li><a href=#the-website>The website</a></li><li><a href=#features>Features</a></li><li><a href=#analysis-of-the-sample>Analysis of the sample</a><ul><li><a href=#permissions-requested>Permissions requested</a></li><li><a href=#randomly-generated-package-name>Randomly generated package name</a></li><li><a href=#getting-the-pin>Getting the PIN</a></li><li><a href=#extracting-and-sending-media-files>Extracting and sending media files</a></li><li><a href=#screen-and-audio-recording>Screen and audio recording</a></li><li><a href=#gps-location>GPS location</a></li></ul></li><li><a href=#closing-remarks>Closing remarks</a><ul><li><a href=#mitre-attck-tactics-and-techniques>Mitre ATT&amp;CK Tactics And Techniques</a></li><li><a href=#yara>YARA</a></li><li><a href=#iocs>IOCs</a></li></ul></li></ul></nav></div></details><script>(function(){"use strict";const s=.33,o="#TableOfContents",i=".anchor",a='a[href^="#"]',r="li ul",c="active";let t=!1;function l(e,n){const o=window.scrollY+window.innerHeight*n,i=[...document.querySelectorAll('#TableOfContents a[href^="#"]')],s=new Set(i.map(e=>e.getAttribute("href").substring(1)));if(t)for(let t=0;t<e.length;t++){const n=e[t];if(!s.has(n.id))continue;const o=n.getBoundingClientRect().top+window.scrollY;if(Math.abs(window.scrollY-o)<100)return n.id}for(let t=e.length-1;t>=0;t--){const n=e[t].getBoundingClientRect().top+window.scrollY;if(n<=o&&s.has(e[t].id))return e[t].id}return e.find(e=>s.has(e.id))?.id||""}function e({toc:e,anchors:t,links:n,scrollOffset:s,collapseInactive:o}){const i=l(t,s);if(!i)return;if(n.forEach(e=>{const t=e.getAttribute("href")===`#${i}`;if(e.classList.toggle(c,t),o){const n=e.closest("li")?.querySelector("ul");n&&(n.style.display=t?"":"none")}}),o){const n=e.querySelector(`a[href="#${CSS.escape(i)}"]`);let t=n;for(;t&&t!==e;)t.tagName==="UL"&&(t.style.display=""),t.tagName==="LI"&&t.querySelector("ul")?.style.setProperty("display",""),t=t.parentElement}}function n(){const n=document.querySelector(o);if(!n)return;const l=!0,u=[...document.querySelectorAll(i)],d=[...n.querySelectorAll(a)];l&&n.querySelectorAll(r).forEach(e=>e.style.display="none"),d.forEach(e=>{e.addEventListener("click",()=>{t=!0})});const c={toc:n,anchors:u,links:d,scrollOffset:s,collapseInactive:l};window.addEventListener("scroll",()=>e(c),{passive:!0}),window.addEventListener("hashchange",()=>e(c),{passive:!0}),e(c)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",n):n()})()</script></div></div><div class="min-w-0 min-h-0 max-w-fit"><div class="article-content max-w-prose mb-20"><p>In this technical blog post, we will examine the components of a stalkerware app designed for Android devices and marketed towards Italian customers. By analyzing the various components of this type of software, hopefully we can gain a deeper understanding of how these apps operate and develop strategies for detecting and removing it from infected devices.</p><h2 class="relative group">What is stalkerware?<div id=what-is-stalkerware class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#what-is-stalkerware aria-label=Anchor>#</a></span></h2><p>Stalkerware is a type of malicious software that is designed to track and monitor someone&rsquo;s digital activity without their knowledge or consent. This type of software is often used by individuals who want to spy on their partners or children, or by employers who want to monitor the activity of their employees. Stalkerware can be used to track a wide range of digital activity, including web searches, geolocation, text messages and chats, photos, voice calls, and more. The use of stalkerware is generally considered unethical and may also be illegal, as it violates the privacy of the targeted individual.</p><p>These apps are often distributed as paid services outside of the Google Play Store, as Google&rsquo;s Developer Program Policy prohibits the distribution of apps that collect and transmit personal or sensitive data from a device without adequate notice or consent (<a href=https://support.google.com/googleplay/android-developer/answer/10065487 target=_blank rel=noreferrer>Developer Program Policy: September 16, 2020 announcement</a>).</p><p>In this post, we will be focusing on a specific Android sample which was developed for the Italian market, as it was advertised in a website in Italian and the code of the sample contains numerous Italian expressions.</p><h2 class="relative group">The website<div id=the-website class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#the-website aria-label=Anchor>#</a></span></h2><p>The app is described on the website as a tool for &ldquo;secretly spying Android phones without being noticed by the owner of the smartphone&rdquo;. The company behind the app claims to be active in 24 countries around the world, with headquarters in Europe, New Zealand, Brazil, and Canada.</p><p>The website of the app includes an End-User License Agreement (EULA) stating that the app should only be installed on devices owned by the user, and it also requires the user to notify any person using a device with the software installed, or any other person with the right to access a monitored account, of the presence of the software.</p><figure><img class="my-0 rounded-md" src=/images/posts/stalkerware-analysis/eula.webp alt="'End-User License agreement' from the website of the app"><figcaption>&lsquo;End-User License Agreement&rsquo; from the website of the app. The highlighted section roughly translates to &lsquo;<em>you also agree to notify on the presence of the software any person using a device with the software installed, or any other person with the right to access a monitored account</em>&rsquo;.</figcaption></figure><p>However, according to the company&rsquo;s website, the most common reason that clients use their stalkerware service is for &ldquo;relationship cheating&rdquo; with 40% of respondents citing this as their motivation; 32% of respondents said that they were using the service to monitor their minor children, and 11% cited &ldquo;personal curiosity, no real reason&rdquo;.</p><figure><img class="my-0 rounded-md" src=/images/posts/stalkerware-analysis/reasons.webp alt="'Reasons for using the spy app' from the website of the app"><figcaption>&lsquo;Reasons for using the spy app&rsquo; from the website of the app</figcaption></figure><p>The licensing model for this stalkerware app includes a free trial of 3 days, during which users have access to all of the features of the app and the online panel for viewing the data captured from the device. After the free trial expires, users must pay a fee of â‚¬22 per month to continue using the service. This fee can be paid via PayPal or credit card, after registering in the admin panel of the website.</p><h2 class="relative group">Features<div id=features class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#features aria-label=Anchor>#</a></span></h2><p>The list of features advertised include the ability to extract WhatsApp audios, pictures, and videos, access all media files on the phone, record calls and ambient audio, record the screen, report on notifications received, list installed apps, and track the phone&rsquo;s location. The website of the app also claims that it is &ldquo;invisible&rdquo; to the user of the phone and to many antivirus solutions.</p><p>To use this stalkerware app, the user must have physical access to the victim&rsquo;s phone and enable the installation of &ldquo;unknown apps&rdquo; from the Android settings. This process can be a bit tedious for non-experienced users, so the website provides various guides and short videos to help users download and install the app on different Android devices and access the panel to view the stolen information.</p><h2 class="relative group">Analysis of the sample<div id=analysis-of-the-sample class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#analysis-of-the-sample aria-label=Anchor>#</a></span></h2><p>The apk sample can be downloaded directly from the website. At time of writing, the sample is not listed in VirusTotal, but we can use a small tool I wrote called apkingo to gather some information on the app:</p><div class=github-card-wrapper><a id=github-14ea2c40e6be00efba898b3f88cfe69f target=_blank href=https://github.com/andpalmier/apkingo class=cursor-pointer><div class="w-full md:w-auto p-0 m-0 border border-neutral-200 dark:border-neutral-700 border rounded-md shadow-2xl"><div class="w-full nozoom"><img src=https://opengraph.githubassets.com/0/andpalmier/apkingo alt="GitHub Repository Thumbnail" class="nozoom mt-0 mb-0 w-full h-full object-cover"></div><div class="w-full md:w-auto pt-3 p-5"><div class="flex items-center"><span class="text-2xl text-neutral-800 dark:text-neutral me-2"><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></span><div id=github-14ea2c40e6be00efba898b3f88cfe69f-full_name class="m-0 font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral">andpalmier/apkingo</div></div><p id=github-14ea2c40e6be00efba898b3f88cfe69f-description class="m-0 mt-2 text-md text-neutral-800 dark:text-neutral">extract info from apk files</p><div class="m-0 mt-2 flex items-center"><span class="mr-1 inline-block h-3 w-3 rounded-full language-dot" data-language=Go></span><div class="m-0 mr-5 text-md text-neutral-800 dark:text-neutral">Go</div><span class="text-md mr-1 text-neutral-800 dark:text-neutral"><span class="relative block icon"><svg viewBox="0 0 576 512"><path fill="currentColor" d="M287.9.0C297.1.0 305.5 5.25 309.5 13.52L378.1 154.8l153.3 22.7C540.4 178.8 547.8 185.1 550.7 193.7 553.5 202.4 551.2 211.9 544.8 218.2L433.6 328.4l26.3 155.5C461.4 492.9 457.7 502.1 450.2 507.4 442.8 512.7 432.1 513.4 424.9 509.1L287.9 435.9 150.1 509.1C142.9 513.4 133.1 512.7 125.6 507.4 118.2 502.1 114.5 492.9 115.1 483.9l27.1-155.5L31.11 218.2C24.65 211.9 22.36 202.4 25.2 193.7 28.03 185.1 35.5 178.8 44.49 177.5L197.7 154.8 266.3 13.52C270.4 5.249 278.7.0 287.9.0zm0 78.95L235.4 187.2C231.9 194.3 225.1 199.3 217.3 200.5L98.98 217.9 184.9 303C190.4 308.5 192.9 316.4 191.6 324.1L171.4 443.7l105.2-56.2C283.7 383.7 292.2 383.7 299.2 387.5l105.2 56.2-20.2-119.6C382.9 316.4 385.5 308.5 391 303l85.9-85.1-118.3-17.4C350.7 199.3 343.9 194.3 340.5 187.2L287.9 78.95z"/></svg></span></span><div id=github-14ea2c40e6be00efba898b3f88cfe69f-stargazers class="m-0 mr-5 text-md text-neutral-800 dark:text-neutral">85</div><span class="text-md mr-1 text-neutral-800 dark:text-neutral"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M80 104c13.3.0 24-10.7 24-24S93.3 56 80 56 56 66.7 56 80s10.7 24 24 24zm80-24c0 32.8-19.7 61-48 73.3V192c0 17.7 14.3 32 32 32H304c17.7.0 32-14.3 32-32V153.3C307.7 141 288 112.8 288 80c0-44.2 35.8-80 80-80s80 35.8 80 80c0 32.8-19.7 61-48 73.3V192c0 53-43 96-96 96H256v70.7c28.3 12.3 48 40.5 48 73.3.0 44.2-35.8 80-80 80s-80-35.8-80-80c0-32.8 19.7-61 48-73.3V288H144c-53 0-96-43-96-96V153.3C19.7 141 0 112.8.0 80 0 35.8 35.8.0 80 0s80 35.8 80 80zm208 24c13.3.0 24-10.7 24-24s-10.7-24-24-24-24 10.7-24 24 10.7 24 24 24zM248 432c0-13.3-10.7-24-24-24s-24 10.7-24 24 10.7 24 24 24 24-10.7 24-24z"/></svg></span></span><div id=github-14ea2c40e6be00efba898b3f88cfe69f-forks class="m-0 mr-5 text-md text-neutral-800 dark:text-neutral">12</div></div></div></div><script async type=text/javascript src=/js/fetch-repo.min.dc5533c50cefd50405344b235937142271f26229fe39cbee27fd4960e8bb897a0beebfad77a1091ca91cd0d1fb14e70fc37cc114dd9674fb2c32e0ab512ec8a4.js integrity="sha512-3FUzxQzv1QQFNEsjWTcUInHyYin+OcvuJ/1JYOi7iXoL7r+td6EJHKkc0NH7FOcPw3zBFN2WdPssMuCrUS7IpA==" data-repo-url=https://api.github.com/repos/andpalmier/apkingo data-repo-id=github-14ea2c40e6be00efba898b3f88cfe69f></script></a></div><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>App name:	X Android Antivirus
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>* General info
</span></span><span class=line><span class=cl>PackageName:	com.vitefa.fosupevilucugo
</span></span><span class=line><span class=cl>Version:	1.0
</span></span><span class=line><span class=cl>MainActivity:	com.vitefa.fosupevilucugo.MainActivity
</span></span><span class=line><span class=cl>MinimumSdk:	22 (Android 5.1)
</span></span><span class=line><span class=cl>TargetSdk:	31 (Android 12)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>* Hash values
</span></span><span class=line><span class=cl>Md5:		67f5f3b3c858453fdc0c901d3f09f985
</span></span><span class=line><span class=cl>Sha1:		86504d29d3d5a852e8e37c951c049917a9b11907
</span></span><span class=line><span class=cl>Sha256:		5ab4ff9f8028c02cbb0886922142227732cfe3aaec99af1a5af2ddb43b0fb5a8
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>* Permissions
</span></span><span class=line><span class=cl>android.permission.ACCESS_NETWORK_STATE
</span></span><span class=line><span class=cl>android.permission.READ_SYNC_STATS
</span></span><span class=line><span class=cl>android.permission.WRITE_SYNC_SETTINGS
</span></span><span class=line><span class=cl>android.permission.AUTHENTICATE_ACCOUNTS
</span></span><span class=line><span class=cl>android.permission.READ_SYNC_SETTINGS
</span></span><span class=line><span class=cl>android.permission.ACCESS_COARSE_LOCATION
</span></span><span class=line><span class=cl>android.permission.ACCESS_FINE_LOCATION
</span></span><span class=line><span class=cl>android.permission.ACCESS_LOCATION_EXTRA_COMMANDS
</span></span><span class=line><span class=cl>android.permission.ACCESS_NOTIFICATION_POLICY
</span></span><span class=line><span class=cl>android.permission.ACCESS_WIFI_STATE
</span></span><span class=line><span class=cl>android.permission.ACCESS_WIMAX_STATE
</span></span><span class=line><span class=cl>android.permission.ACTION_MANAGE_OVERLAY_PERMISSION
</span></span><span class=line><span class=cl>android.permission.BODY_SENSORS
</span></span><span class=line><span class=cl>android.permission.BROADCAST_STICKY
</span></span><span class=line><span class=cl>android.permission.CALL_PHONE
</span></span><span class=line><span class=cl>android.permission.CAMERA
</span></span><span class=line><span class=cl>android.permission.CHANGE_NETWORK_STATE
</span></span><span class=line><span class=cl>android.permission.CHANGE_WIFI_MULTICAST_STATE
</span></span><span class=line><span class=cl>android.permission.CHANGE_WIFI_STATE
</span></span><span class=line><span class=cl>android.permission.CHANGE_WIMAX_STATE
</span></span><span class=line><span class=cl>android.permission.DISABLE_KEYGUARD
</span></span><span class=line><span class=cl>android.permission.GET_ACCOUNTS
</span></span><span class=line><span class=cl>android.permission.INTERNET
</span></span><span class=line><span class=cl>android.permission.MANAGE_ACCOUNTS
</span></span><span class=line><span class=cl>android.permission.MODIFY_AUDIO_SETTINGS
</span></span><span class=line><span class=cl>android.permission.PERSISTENT_ACTIVITY
</span></span><span class=line><span class=cl>android.permission.PROCESS_OUTGOING_CALLS
</span></span><span class=line><span class=cl>android.permission.PACKAGE_USAGE_STATS
</span></span><span class=line><span class=cl>android.permission.READ_CELL_BROADCASTS
</span></span><span class=line><span class=cl>android.permission.READ_CONTACTS
</span></span><span class=line><span class=cl>android.permission.READ_EXTERNAL_STORAGE
</span></span><span class=line><span class=cl>android.permission.READ_PHONE_STATE
</span></span><span class=line><span class=cl>android.permission.READ_INSTALL_SESSIONS
</span></span><span class=line><span class=cl>android.permission.READ_PROFILE
</span></span><span class=line><span class=cl>android.permission.READ_SMS
</span></span><span class=line><span class=cl>android.permission.RECEIVE_MMS
</span></span><span class=line><span class=cl>android.permission.RECEIVE_SMS
</span></span><span class=line><span class=cl>android.permission.RECORD_AUDIO
</span></span><span class=line><span class=cl>android.permission.CAPTURE_AUDIO_OUTPUT
</span></span><span class=line><span class=cl>android.permission.REQUEST_IGNORE_BATTERY_OPTIMIZATIONS
</span></span><span class=line><span class=cl>android.permission.RESTART_PACKAGES
</span></span><span class=line><span class=cl>android.permission.SEND_SMS
</span></span><span class=line><span class=cl>android.permission.SET_ALARM
</span></span><span class=line><span class=cl>com.android.alarm.permission.SET_ALARM
</span></span><span class=line><span class=cl>android.permission.USE_SIP
</span></span><span class=line><span class=cl>android.permission.WAKE_LOCK
</span></span><span class=line><span class=cl>android.permission.WRITE_CALENDAR
</span></span><span class=line><span class=cl>android.permission.WRITE_CALL_LOG
</span></span><span class=line><span class=cl>android.permission.WRITE_CONTACTS
</span></span><span class=line><span class=cl>android.permission.WRITE_EXTERNAL_STORAGE
</span></span><span class=line><span class=cl>android.permission.MANAGE_EXTERNAL_STORAGE
</span></span><span class=line><span class=cl>android.permission.FOREGROUND_SERVICE
</span></span><span class=line><span class=cl>com.donnemartin.android.fieldreporter.permission.MAPS_RECEIVE
</span></span><span class=line><span class=cl>com.google.android.providers.gsf.permission.READ_GSERVICES
</span></span><span class=line><span class=cl>android.permission.sec.MDM_APP_MGMT
</span></span><span class=line><span class=cl>android.permission.ACCESS_BACKGROUND_LOCATION
</span></span><span class=line><span class=cl>android.permission.MANAGE_OWN_CALLS
</span></span><span class=line><span class=cl>android.permission.READ_CALL_LOG
</span></span><span class=line><span class=cl>android.permission.ANSWER_PHONE_CALLS
</span></span><span class=line><span class=cl>android.permission.USE_ICC_AUTH_WITH_DEVICE_IDENTIFIER
</span></span><span class=line><span class=cl>android.permission.READ_PRIVILEGED_PHONE_STATE
</span></span><span class=line><span class=cl>android.permission.SYSTEM_ALERT_WINDOW
</span></span><span class=line><span class=cl>android.permission.SCHEDULE_EXACT_ALARM
</span></span><span class=line><span class=cl>android.permission.MANAGE_MEDIA
</span></span><span class=line><span class=cl>android.permission.VIBRATE
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>* Metadata
</span></span><span class=line><span class=cl>no metadata found
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>* Certificate
</span></span><span class=line><span class=cl>Serial:		2126353726
</span></span><span class=line><span class=cl>Sha1:		f3e17dfdb98b1f7774a16967fd1d84d3d9d59389
</span></span><span class=line><span class=cl>Subject:	C=US, O=corudagiruducodi, CN=corudagiruducodi
</span></span><span class=line><span class=cl>Issuer:		C=US, O=corudagiruducodi, CN=corudagiruducodi
</span></span><span class=line><span class=cl>ValidFrom:	09 Dec 22 13:04 UTC
</span></span><span class=line><span class=cl>ValidTo:	23 Sep 96 13:04 UTC
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>* Play Store
</span></span><span class=line><span class=cl>app not found in Play Store</span></span></code></pre></div></div><p>This sample was named like an antivirus app, in order to make the victim think it is safe.</p><figure><img class="my-0 rounded-md" src=/images/posts/stalkerware-analysis/icon.webp alt="app icon"><figcaption>Icon of this sample</figcaption></figure><h3 class="relative group">Permissions requested<div id=permissions-requested class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#permissions-requested aria-label=Anchor>#</a></span></h3><p>One tactic commonly used by stalkerware apps is to request a large number of permissions from the user, including access to call logs, contacts, camera, messages, and microphone. This is often done without the user&rsquo;s knowledge or consent, as stalkerware apps are designed to be installed behind the user&rsquo;s back.</p><p><figure><img class="my-0 rounded-md" src=/images/posts/stalkerware-analysis/permissions.webp alt="permissions asked by the stalkerware"><figcaption>List of permissions aked by the stalkerweare</figcaption></figure><figure><img class="my-0 rounded-md" src=/images/posts/stalkerware-analysis/notification.webp alt="notification access"><figcaption>Notification access requested by the sample</figcaption></figure></p><p>In addition to requesting all these permissions, the sample is abusing Accessibility services and Device administration features of Android. Accessibility services are designed to help users with disabilities interact with their devices, but malicious apps can request access to these services in order to gain additional permissions on a device, such as: read and intercept text messages and notifications, even control the device simulating clicks, drawing over other apps and even reading the screen while other apps are being used. Device administration features, instead, allows IT departments to ensure the security and compliance of their devices by remotely controlling various settings and even remotely locking or wiping the device in case it was stolen. By requesting device administrator privileges, the sample can greatly extend its capabilities (as shown in the screenshot below) and even make it more difficult for the user to remove the app from their device.</p><p><figure><img class="my-0 rounded-md" src=/images/posts/stalkerware-analysis/deviceadmin.webp alt="abusing device admin"></figure><figure><img class="my-0 rounded-md" src=/images/posts/stalkerware-analysis/deviceadmin2.webp alt="abusing device admin pt2"><figcaption>The stalkerware abusing the &lsquo;Device administration&rsquo; feature of Android</figcaption></figure></p><h3 class="relative group">Randomly generated package name<div id=randomly-generated-package-name class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#randomly-generated-package-name aria-label=Anchor>#</a></span></h3><p>The package name of an Android app is used to uniquely identifies the app on the device and in the stores; usually developers choose a package name with a reference to the company developing the app or the product, but in this sample the package name is a bit odd. Downloading multiple samples of the app from the website, it is possible to note that every apk has a different package name and different certificate issuer, and both appear to be randomly generated.</p><p>This approach could be used for evading antivirus detections based on the package name and the hash of the apk, as well as for distinguishing between different licenses. The randomly generated package name is specified in the <code>strings.xml</code> file, and here are these sections for two different samples:</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;string</span> <span class=na>name=</span><span class=s>&#34;ACCOUNT_TYPE&#34;</span><span class=nt>&gt;</span>com.vitefa.fosupevilucugo.sync<span class=nt>&lt;/string&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;string</span> <span class=na>name=</span><span class=s>&#34;AUTORITY&#34;</span><span class=nt>&gt;</span>com.vitefa.fosupevilucugo.sync.StubProvider<span class=nt>&lt;/string&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nt>&lt;string</span> <span class=na>name=</span><span class=s>&#34;ACCOUNT_TYPE&#34;</span><span class=nt>&gt;</span>com.babili.ribisosisubugu.sync<span class=nt>&lt;/string&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;string</span> <span class=na>name=</span><span class=s>&#34;AUTORITY&#34;</span><span class=nt>&gt;</span>com.babili.ribisosisubugu.sync.StubProvider<span class=nt>&lt;/string&gt;</span></span></span></code></pre></div></div><p>The strings <code>ACCOUNT_TYPE</code> and <code>AUTORITY</code> are referenced in the code while setting app the account of the service used to send the data to the online panel:</p><figure><img class="my-0 rounded-md" src=/images/posts/stalkerware-analysis/account.webp alt="account class definition"><figcaption>Definition of the &lsquo;account&rsquo; class using <code>AUTORITY</code> and <code>ACCOUNT_TYPE</code></figcaption></figure><h3 class="relative group">Getting the PIN<div id=getting-the-pin class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#getting-the-pin aria-label=Anchor>#</a></span></h3><p>Right after installing the app, the following message will be shown: <em>&ldquo;Wait 5 seconds. Some windows may appear asking for authorization, accept and confirm everything. Below is a continuous button. After clicking on it, a numeric PIN will appear. You must enter the numeric PIN in our control panel, see the installation and license activation guides on our site. By clicking the continue button below you declare that you have read and accepted all the conditions on the site.&rdquo;</em></p><figure><img class="my-0 rounded-md" src=/images/posts/stalkerware-analysis/postinstallation.webp alt="post installation message"><figcaption>A screenshot showing part of the post-installation message</figcaption></figure><p>The PIN appearing after this prompt must be entered in the control panel to access the data stolen from the device. To retrieve this PIN, the app first attempts to generate a fingerprint of the device by gathering hardware and software information about it, like IMEI number, manufacturer and model, screen resolution, SDK version and build ID:</p><figure><img class="my-0 rounded-md" src=/images/posts/stalkerware-analysis/getpinfromserver.webp alt="gathering info on the device"><figcaption>The function <code>getPinFromServer</code> is used to gather information about the device</figcaption></figure><p>The information obtained are then used to call the <code>getPin</code> function, which connects to the server, submits all the details gathered, and parses the response from the server to get the PIN associated with the license:</p><figure><img class="my-0 rounded-md" src=/images/posts/stalkerware-analysis/getpin.webp alt="getting the pin"><figcaption>The function <code>getPin</code> is used to retrieve the PIN from the server</figcaption></figure><figure><img class="my-0 rounded-md" src=/images/posts/stalkerware-analysis/pindisplayed.webp alt="pin received"><figcaption>Message displayed after obtaining the PIN (a 9-digit number)</figcaption></figure><p>After entering the PIN received into the control panel, we can now send commands to the phone to perform various actions (see screenshot below), listen to phone calls, view media files stolen from the device, and even check the status of the permissions enabled for the stalkerware app.</p><figure><img class="my-0 rounded-md" src=/images/posts/stalkerware-analysis/cmdlist.webp alt="cmd list"><figcaption>The list of commands available from the control panel: record audio for 6 seconds, 2, 5, 15 and 30 minutes, ask for GPS position, download data, record screen, and take a picture</figcaption></figure><h3 class="relative group">Extracting and sending media files<div id=extracting-and-sending-media-files class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#extracting-and-sending-media-files aria-label=Anchor>#</a></span></h3><p>One of the major feature provided by the stalkerware app is the extraction of all the media files stored in the device, including pictures and videos from WhatsApp chats. This feature is provided by the <code>extractMedia</code> function, which is designed to access the external and internal storage of the device, and it contains a call to the <code>getMedia</code> function, which searches for media files within the specified directory and its subdirectories:</p><figure><img class="my-0 rounded-md" src=/images/posts/stalkerware-analysis/extractmedia.webp alt="extracting media files"><figcaption>Content of<code>extractMedia</code> and <code>getMedia</code> functions</figcaption></figure><p>The <code>getMedia</code> function contains a call to <code>getFile</code>, which has the purpose of storing the name of the file found either in <code>mediaWhatsapp</code> or <code>media</code> (depending on where the file was found); both of these are SQL database used to store which files are sent to the server. The function is then used to call <code>FileClientNoDelete</code> on every file.</p><figure><img class="my-0 rounded-md" src=/images/posts/stalkerware-analysis/getfile.webp alt="getFile function"><figcaption>Content of <code>getFile</code> function</figcaption></figure><figure><img class="my-0 rounded-md" src=/images/posts/stalkerware-analysis/sendfile.webp alt=sendfile><figcaption>Content of <code>FileClientNoDelete</code> and <code>sendFile</code></figcaption></figure><p>The class <code>FileClientNoDelete</code> describes a client which can send a file to the remote server over a socket connection. When an object of <code>FileClientNoDelete</code> is created, it establishes a socket connection with the server at the specified IP address and port, and sets the timeout value of the socket to 15 minutes. Then it calls <code>sendFile</code>, which after writing the file name, the PIN number and the file length to the output stream of the socket, sends the specified file to the server by reading the file in 1024-byte chunks and writing them to the output stream until the end of the file is reached.</p><h3 class="relative group">Screen and audio recording<div id=screen-and-audio-recording class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#screen-and-audio-recording aria-label=Anchor>#</a></span></h3><p>This sample extends the Android class <code>MediaProjection</code> to capture screen contents and/or record system audio.</p><p>The function below is responsible for initializing, preparing, and starting the screen recording: it first retrieves the screen density of the device and initializes and prepares the media recorder by creating a <code>MediaProjectionCallback</code> instance, registering it with the media projection and creating a virtual display for the screen recording using the <code>createVirtualDisplay</code> function. Finally, it starts the media recorder and leave it working for 10 seconds, before stopping it.</p><figure><img class="my-0 rounded-md" src=/images/posts/stalkerware-analysis/videorec.webp alt="screen recording function"><figcaption>Function used to setup recording of the screen</figcaption></figure><p>A second class is used to capture audio from the device and record it to a file. The code below shows how the sample does this by creating an instance of <code>AudioRecord</code> and calling its <code>startRecording()</code> method. It then creates a new thread which will run a method called <code>writeAudioDataToFile()</code>, which will be responsible for writing the recorded audio data to a file.</p><figure><img class="my-0 rounded-md" src=/images/posts/stalkerware-analysis/audiorec.webp alt="audio recording function"><figcaption>Function used to setup audio recording</figcaption></figure><p>Another functionality of the stalkerware app is the recording of WhatsApp calls. The code below is using Android&rsquo;s accessibility services to identify which app is currently opened on the device, check if a WhatsApp call is happening, and extract the name or the phone number having a call with the victim. The code then checks for a view with the resource name <code>end_call_btn</code>, and if it finds it, it will attempt to record the audio call by using the service <code>rCallVoip</code>.</p><figure><img class="my-0 rounded-md" src=/images/posts/stalkerware-analysis/whatsapprec.webp alt="whatsapp call recording"><figcaption>Function used to record WhatsApp calls</figcaption></figure><figure><img class="my-0 rounded-md" src=/images/posts/stalkerware-analysis/rcallvoip.webp alt=rcallvoip><figcaption>Function called when for the service <code>rCallVoip</code> is created</figcaption></figure><h3 class="relative group">GPS location<div id=gps-location class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#gps-location aria-label=Anchor>#</a></span></h3><p>The sample is also able to get the device&rsquo;s current location by using either GPS or the device&rsquo;s mobile network.</p><figure><img class="my-0 rounded-md" src=/images/posts/stalkerware-analysis/getpos.webp alt="get position of the device"><figcaption>Function used to obtain the position of the device</figcaption></figure><p>The function above checks if either GPS or the device&rsquo;s mobile network is enabled on the device: if one of those is enabled, it starts listening for location updates from the chosen provider. When the device&rsquo;s location changes, the method <code>onLocationChanged</code> is called to write latitute and longitude coordinates in an XML document:</p><figure><img class="my-0 rounded-md" src=/images/posts/stalkerware-analysis/locchanged.webp alt="record device movement"><figcaption>Function called when the position of the device changes</figcaption></figure><h2 class="relative group">Closing remarks<div id=closing-remarks class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#closing-remarks aria-label=Anchor>#</a></span></h2><p>In conclusion, the android stalkerware app that was analyzed is a concerning and potentially dangerous tool. It has the ability to track a person&rsquo;s location, access their messaging and call logs, and even record their phone calls without their knowledge or consent. This type of app can be used to stalk and harass individuals, and it raises serious privacy and security concerns. If you read this post and you now suspect there may be stalkerware on your device, refer to <a href=https://stopstalkerware.org/information-for-survivors/ target=_blank rel=noreferrer>this article</a> from the <a href=https://stopstalkerware.org/ target=_blank rel=noreferrer>Coalition Against Stalkerware</a>.</p><h3 class="relative group">Mitre ATT&amp;CK Tactics And Techniques<div id=mitre-attck-tactics-and-techniques class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#mitre-attck-tactics-and-techniques aria-label=Anchor>#</a></span></h3><p><strong>TA0011 - Command and Control</strong></p><ul><li>T1071 - Application Layer Protocol (<em>uses HTTPS and performs DNS lookups</em>)</li><li>T1095 - Non-Application Layer Protocol (<em>performs DNS lookups</em>)</li><li>T1573 - Encrypted Channel (<em>uses HTTPS</em>)</li></ul><p><strong>TA0030 - Defense Evasion</strong></p><ul><li>T1418 - Software Discovery (<em>queries a list of installed applications</em>)</li><li>T1447 - Delete Device Data (<em>lists and deletes files in the same context</em>)</li></ul><p><strong>TA0031 - Credential Access</strong></p><ul><li>T1409 - Stored Application Data (<em>queries stored mail and application accounts like Gmail or WhatsApp</em>)</li><li>T1412 - Capture SMS Messages (<em>monitors incoming SMS</em>)</li></ul><p><strong>TA0032 - Discovery</strong></p><ul><li>T1418 - Software Discovery (<em>queries a list of installed applications</em>)</li><li>T1421 - System Network Connections Discovery (<em>checks an internet connection is available</em>)</li><li>T1426 - System Information Discovery (<em>queries the unique device ID)</em></li><li>T1430 - Location Tracking (<em>queries the phone&rsquo;s location</em>)</li></ul><p><strong>TA0034 - Impact</strong></p><ul><li>T1447 - Delete Device Data (<em>lists and deletes files in the same context</em>)</li><li>T1448 - Carrier Billing Fraud (<em>has permission to send SMS in the background</em>)</li></ul><p><strong>TA0035 - Collection</strong></p><ul><li>T1409 - Stored Application Data (<em>queries stored mail and application accounts like Gmail or WhatsApp)</em></li><li>T1412 - Capture SMS Messages (<em>monitors incoming SMS</em>)</li><li>T1429 - Audio Capture (<em>accesses the audio/media managers and records audio/media</em>)</li><li>T1430 - Location Tracking (<em>queries the phones location</em>)</li><li>T1432 - Access Contact List (<em>queries phone contact information</em>)</li><li>T1433 - Access Call Log (<em>monitors incoming and outgoing Phone calls</em>)</li><li>T1507 - Network Information Discovery (<em>checks an internet connection is available</em>)</li></ul><p><strong>TA0038 - Network Effects</strong></p><ul><li>T1449 - Exploit SS7 to Redirect Phone Calls/SMS (<em>has permissions to perform, monitor, redirect and/or block calls and to send SMS in the background</em>)</li></ul><h3 class="relative group">YARA<div id=yara class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#yara aria-label=Anchor>#</a></span></h3><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=n>rule</span> <span class=nl>italianstalkerware</span> <span class=p>:</span> <span class=n>stalkerware</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nl>meta</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>author</span> <span class=o>=</span> <span class=s>&#34;Andrea Palmieri @andpalmier&#34;</span>
</span></span><span class=line><span class=cl>	<span class=n>ref</span> <span class=o>=</span> <span class=s>&#34;https://andpalmier.com/posts/stalkerware-analysis/&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nl>strings</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=err>$</span><span class=n>s1</span> <span class=o>=</span> <span class=s>&#34;cliccando il bottone continua sottostante&#34;</span> <span class=n>nocase</span> <span class=n>ascii</span>
</span></span><span class=line><span class=cl>        <span class=err>$</span><span class=n>s2</span> <span class=o>=</span> <span class=s>&#34;www.spyapp.ch/eula&#34;</span> <span class=n>nocase</span> <span class=n>ascii</span>
</span></span><span class=line><span class=cl>	    <span class=err>$</span><span class=n>s3</span> <span class=o>=</span> <span class=s>&#34;periodicamente il sistema viene aggiornato&#34;</span> <span class=n>nocase</span> <span class=n>ascii</span>
</span></span><span class=line><span class=cl>    <span class=nl>condition</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nf>uint16</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span> <span class=o>==</span> <span class=mh>0x4B50</span> <span class=n>and</span> <span class=mi>3</span> <span class=n>of</span> <span class=n>them</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div><h3 class="relative group">IOCs<div id=iocs class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#iocs aria-label=Anchor>#</a></span></h3><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>u1623673571u.apk	86504d29d3d5a852e8e37c951c049917a9b11907
</span></span><span class=line><span class=cl>u187763837u.apk 	19d990ace5e4fd5871265485d2ec4431bba33f28
</span></span><span class=line><span class=cl>u555625802u.apk		8fbaa94dfdce19e5484e12bac0ce4cbe56d908d8</span></span></code></pre></div></div></div><section class="flex flex-row flex-wrap justify-center pt-4 text-xl"><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=/posts/stalkerware-analysis/&amp;title=Dissecting%20an%20Android%20stalkerware" title="Share on LinkedIn" aria-label="Share on LinkedIn"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://twitter.com/intent/tweet/?url=/posts/stalkerware-analysis/&amp;text=Dissecting%20an%20Android%20stalkerware" title="Tweet on Twitter" aria-label="Tweet on Twitter"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg></span>
</a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://bsky.app/intent/compose?text=Dissecting%20an%20Android%20stalkerware+/posts/stalkerware-analysis/" title="Post on Bluesky" aria-label="Post on Bluesky"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 232.562c-21.183-41.196-78.868-117.97-132.503-155.834-51.378-36.272-70.978-29.987-83.828-24.181-14.872 6.72-17.577 29.554-17.577 42.988.0 13.433 7.365 110.138 12.169 126.281 15.873 53.336 72.376 71.358 124.413 65.574 2.66-.395 5.357-.759 8.089-1.097-2.68.429-5.379.796-8.089 1.097-76.259 11.294-143.984 39.085-55.158 137.972C201.224 526.527 237.424 403.67 256 341.379c18.576 62.291 39.972 180.718 150.734 83.983 83.174-83.983 22.851-126.674-53.408-137.969-2.71-.302-5.409-.667-8.089-1.096 2.732.337 5.429.702 8.089 1.096 52.037 5.785 108.54-12.239 124.413-65.574 4.804-16.142 12.169-112.847 12.169-126.281.0-13.434-2.705-36.267-17.577-42.988-12.85-5.806-32.45-12.09-83.829 24.181C334.868 114.595 277.183 191.366 256 232.562z"/></svg></span>
</a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://s2f.kytta.dev/?text=Dissecting%20an%20Android%20stalkerware%20/posts/stalkerware-analysis/" title="Share via Mastodon" aria-label="Share via Mastodon"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48.0.0.0-63.72 28.5-63.72 125.7.0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.54 102.54.0 01-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5zm-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://reddit.com/submit/?url=/posts/stalkerware-analysis/&amp;resubmit=true&amp;title=Dissecting%20an%20Android%20stalkerware" title="Submit to Reddit" aria-label="Submit to Reddit"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M201.5 305.5c-13.8.0-24.9-11.1-24.9-24.6.0-13.8 11.1-24.9 24.9-24.9 13.6.0 24.6 11.1 24.6 24.9.0 13.6-11.1 24.6-24.6 24.6zM504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248zm-132.3-41.2c-9.4.0-17.7 3.9-23.8 10-22.4-15.5-52.6-25.5-86.1-26.6l17.4-78.3 55.4 12.5c0 13.6 11.1 24.6 24.6 24.6 13.8.0 24.9-11.3 24.9-24.9s-11.1-24.9-24.9-24.9c-9.7.0-18 5.8-22.1 13.8l-61.2-13.6c-3-.8-6.1 1.4-6.9 4.4l-19.1 86.4c-33.2 1.4-63.1 11.3-85.5 26.8-6.1-6.4-14.7-10.2-24.1-10.2-34.9.0-46.3 46.9-14.4 62.8-1.1 5-1.7 10.2-1.7 15.5.0 52.6 59.2 95.2 132 95.2 73.1.0 132.3-42.6 132.3-95.2.0-5.3-.6-10.8-1.9-15.8 31.3-16 19.8-62.5-14.9-62.5zM302.8 331c-18.2 18.2-76.1 17.9-93.6.0-2.2-2.2-6.1-2.2-8.3.0-2.5 2.5-2.5 6.4.0 8.6 22.8 22.8 87.3 22.8 110.2.0 2.5-2.2 2.5-6.1.0-8.6-2.2-2.2-6.1-2.2-8.3.0zm7.7-75c-13.6.0-24.6 11.1-24.6 24.9.0 13.6 11.1 24.6 24.6 24.6 13.8.0 24.9-11.1 24.9-24.6.0-13.8-11-24.9-24.9-24.9z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://www.facebook.com/sharer/sharer.php?u=/posts/stalkerware-analysis/&amp;quote=Dissecting%20an%20Android%20stalkerware" title="Share on Facebook" aria-label="Share on Facebook"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14.0 55.52 4.84 55.52 4.84v61h-31.28c-30.8.0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg></span></a></section><h2 class="mt-8 text-2xl font-extrabold mb-10">Related</h2><section class="w-full grid gap-4 sm:grid-cols-2 md:grid-cols-3"><article class="article-link--related relative min-h-full min-w-full overflow-hidden rounded-lg border border-neutral-300 dark:border-neutral-600"><div class="flex-none relative overflow-hidden thumbnail_card_related"><img src=/posts/emotet-php-maldoc/featured_hu_134ffa6bcff815b0.jpg role=presentation loading=lazy decoding=async fetchpriority=low class="not-prose absolute inset-0 w-full h-full object-cover"></div><div class=p-4><header><a href=/posts/emotet-php-maldoc/ class="not-prose before:absolute before:inset-0 decoration-primary-500 dark:text-neutral text-xl font-bold text-neutral-800 hover:underline hover:underline-offset-2"><h2>Emotet infection from PHP: generation of a malicious doc</h2></a></header><div class="text-sm text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime=2020-10-12T10:33:45+02:00>12 October 2020</time><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">7 mins</span></div><div class="flex flex-row flex-wrap items-center"></div></div></div><div class="px-6 pt-4 pb-2"></div></article><article class="article-link--related relative min-h-full min-w-full overflow-hidden rounded-lg border border-neutral-300 dark:border-neutral-600"><div class="flex-none relative overflow-hidden thumbnail_card_related"><img src=/posts/poc-goransom/featured_hu_cff97040ecf993e1.jpg role=presentation loading=lazy decoding=async fetchpriority=low class="not-prose absolute inset-0 w-full h-full object-cover"></div><div class=p-4><header><a href=/posts/poc-goransom/ class="not-prose before:absolute before:inset-0 decoration-primary-500 dark:text-neutral text-xl font-bold text-neutral-800 hover:underline hover:underline-offset-2"><h2>Proof of concept of a ransomware in Go</h2></a></header><div class="text-sm text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime=2020-07-29T00:00:00+00:00>29 July 2020</time><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">7 mins</span></div><div class="flex flex-row flex-wrap items-center"></div></div></div><div class="px-6 pt-4 pb-2"></div></article><article class="article-link--related relative min-h-full min-w-full overflow-hidden rounded-lg border border-neutral-300 dark:border-neutral-600"><div class="flex-none relative overflow-hidden thumbnail_card_related"><img src=/posts/practical-malware-lab1/featured_hu_685f0df499c23a43.png role=presentation loading=lazy decoding=async fetchpriority=low class="not-prose absolute inset-0 w-full h-full object-cover"></div><div class=p-4><header><a href=/posts/practical-malware-lab1/ class="not-prose before:absolute before:inset-0 decoration-primary-500 dark:text-neutral text-xl font-bold text-neutral-800 hover:underline hover:underline-offset-2"><h2>Practical malware analysis: solutions for Lab 1</h2></a></header><div class="text-sm text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime=2020-04-21T00:00:00+00:00>21 April 2020</time><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">8 mins</span></div><div class="flex flex-row flex-wrap items-center"></div></div></div><div class="px-6 pt-4 pb-2"></div></article></section></div><script type=text/javascript src=/js/page.min.54b6f4371722649edbe871e431d8670d670878c22be8f36e229fe53cc9b786fe25a834def5e6de621f7a3e37b72bc8cd73839aa5ed907ed6cbd45cd3e1b0fa20.js integrity="sha512-VLb0NxciZJ7b6HHkMdhnDWcIeMIr6PNuIp/lPMm3hv4lqDTe9ebeYh96Pje3K8jNc4Oape2QftbL1FzT4bD6IA==" data-oid=views_posts/stalkerware-analysis/index.md data-oid-likes=likes_posts/stalkerware-analysis/index.md></script></section><footer class="pt-8 max-w-prose print:hidden"><div class=pt-3><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class=pt-3><script src=https://giscus.app/client.js data-repo=andpalmier/andpalmier.github.io data-repo-id=R_kgDOGcbGMQ data-category=General data-category-id=DIC_kwDOGcbGMc4CleV- data-mapping=title data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=en crossorigin=anonymous async></script></div></div></footer></article><div id=scroll-to-top class="fixed bottom-6 end-6 z-50 transform translate-y-4 opacity-0 duration-200"><a href=#the-top class="pointer-events-auto flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div></main><footer id=site-footer class="py-10 print:hidden"><div class="flex items-center justify-between"><p class="text-sm text-neutral-500 dark:text-neutral-400">2025 - <a href=https://andpalmier.com target=_blank rel=noreferrer>andpalmier.com</a></p></div><script>mediumZoom(document.querySelectorAll("img:not(.nozoom)"),{margin:24,background:"rgba(0,0,0,0.5)",scrollOffset:0})</script><script type=text/javascript src=/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh+sCQ0E53ghYrxgYqw+0GCRyIEpA=="></script></footer><div id=search-wrapper class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500" data-url=/><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=Search tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="Close (Esc)">
<span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></body></html>